<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="mapModal-content">
<head>    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.0/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=z9fdx1to2u"></script>
    <style>
        .image-map-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .image-map-container > div {
            flex: 0 0 48%;  /* 각 요소가 컨테이너의 48%를 차지하도록 설정 */
            margin: 10px;
            border: 1px solid #000;
        }
        .restaurant-image, #map {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <span class="closeMapModal">&times;</span>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="image-map-container">
                    <div>   
                        <img th:src="${restaurant.imageUrl}" alt="Restaurant Image" class="restaurant-image" style="width:100%; height: 400px;">
                    </div>
                    <div>
                        <div id="map" style="width:100%;height:400px;"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-12 restaurant-info">
                <h3 id="title" th:text="${restaurant.title}"></h3>
                <p><i class="bi bi-geo-alt-fill"></i> <span th:text="${restaurant.address}"></span></p>
                <p><i class="bi bi-tag-fill"></i> <span th:text="${restaurant.category}"></span></p>
                <p th:if="${restaurant.link != null and restaurant.link != ''}"><i class="bi bi-link"></i>  <a th:href="${restaurant.link}" th:text="${restaurant.link}" target="_blank"></a></p>
                <!-- Hidden elements for coordinates -->
                <span id="mapx" th:text="${restaurant.mapx}" style="display: none;"></span>
                <span id="mapy" th:text="${restaurant.mapy}" style="display: none;"></span>
            </div>
        </div>
    </div>
    <script th:inline="javascript">
        /*<![CDATA[*/
        var restaurant = /*[[${restaurant}]]*/ null;
        function createMap(mapx, mapy) {
            try {
                console.log("Creating map with coordinates:", mapx, mapy)    
                var tm128 = new naver.maps.Point(mapx, mapy);
                var latLng = naver.maps.TransCoord.fromTM128ToLatLng(tm128);
                var mapOptions = {
                    center: latLng,
                    zoom: 15
                };
                var map = new naver.maps.Map('map', mapOptions);
                var marker = new naver.maps.Marker({
                    position: latLng,
                    map: map
                });
            } catch (error) {
                console.log("Error creating map:", error);
            }
        }
        if (restaurant && restaurant.mapx && restaurant.mapy) {
            createMap(restaurant.mapx, restaurant.mapy);
        } else {
            console.error("Restaurant data is missing or incomplete");
        }
        /*]]>*/
    </script>
</body>
</th:block>
</html>